define(["jquery","taskQueue"],function(s,A){var h=window.idbModules={},k=function(){this.length=0;this._items=[]};k.prototype={contains:function(a){return-1!==this._items.indexOf(a)},item:function(a){return this._items[a]},indexOf:function(a){return this._items.indexOf(a)},push:function(a){this._items.push(a);this.length+=1},splice:function(){this._items.splice.apply(this._items,arguments);this.length=this._items.length}};h.util={throwDOMException:function(a,b,f){var d=new DOMException.constructor(0,
b);d.name=a;d.message=b;d.stack=arguments.callee.caller;h.DEBUG&&console.log(a,b,f,d);throw d;},callback:function(a,b,f,d){f.target=b;"function"===typeof b[a]&&b[a].apply(b,[f]);"function"===typeof d&&d()},quote:function(a){return"'"+a+"'"},StringList:k};h.Sca={encode:function(a){return JSON.stringify(a)},decode:function(a){return JSON.parse(a)}};var t=" number string boolean object undefined".split(" "),k=function(){return{encode:function(a){return t.indexOf(typeof a)+"-"+JSON.stringify(a)},decode:function(a){return"undefined"===
typeof a?void 0:JSON.parse(a.substring(2))}}},w={number:k("number"),"boolean":k(),object:k(),string:{encode:function(a){return t.indexOf("string")+"-"+a},decode:function(a){return""+a.substring(2)}},undefined:{encode:function(){return t.indexOf("undefined")+"-undefined"},decode:function(){}}};h.Key={encode:function(a){return w[typeof a].encode(a)},decode:function(a){return w[t[a.substring(0,1)]].decode(a)}};h.Event=function(a,b){return{type:a,debug:b,bubbles:!1,cancelable:!1,eventPhase:0,timeStamp:new Date}};
var k=function(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null;this.readyState="pending"},x=function(){this.onblocked=this.onupgradeneeded=null};x.prototype=k;h.IDBRequest=k;h.IDBOpenRequest=x;var q=function(a,b,f,d){this.lower=a;this.upper=b;this.lowerOpen=f;this.upperOpen=d};q.only=function(a){return new q(a,a,!0,!0)};q.lowerBound=function(a,b){return new q(a,void 0,b,void 0)};q.upperBound=function(a){return new q(void 0,a,void 0,open)};q.bound=function(a,
b,f,d){return new q(a,b,f,d)};h.IDBKeyRange=q;k=function(a,b,f,d,c,e){this.__range=a;this.source=this.__idbObjectStore=f;this.__req=d;this.key=void 0;this.direction=b;this.__keyColumnName=c;this.__valueColumnName=e;this.source.transaction.__active||h.util.throwDOMException("TransactionInactiveError - The transaction this IDBObjectStore belongs to is not active.");this.__offset=-1;this.__lastKeyContinued=void 0;this["continue"]()};k.prototype.__find=function(a,b,f,d){var c=this,e=["SELECT * FROM ",
h.util.quote(c.__idbObjectStore.name)],j=[];e.push("WHERE ",c.__keyColumnName," NOT NULL");if(c.__range&&(c.__range.lower||c.__range.upper))e.push("AND"),c.__range.lower&&(e.push(c.__keyColumnName+(c.__range.lowerOpen?" >=":" >")+" ?"),j.push(h.Key.encode(c.__range.lower))),c.__range.lower&&c.__range.upper&&e.push("AND"),c.__range.upper&&(e.push(c.__keyColumnName+(c.__range.upperOpen?" <= ":" < ")+" ?"),j.push(h.Key.encode(c.__range.upper)));"undefined"!==typeof a&&(c.__lastKeyContinued=a,c.__offset=
0);void 0!==c.__lastKeyContinued&&(e.push("AND "+c.__keyColumnName+" >= ?"),j.push(h.Key.encode(c.__lastKeyContinued)));e.push("ORDER BY ",c.__keyColumnName);e.push("LIMIT 1 OFFSET "+c.__offset);h.DEBUG&&console.log(e.join(" "),j);b.executeSql(e.join(" "),j,function(a,b){if(1===b.rows.length){var d=h.Key.decode(b.rows.item(0)[c.__keyColumnName]),e="value"===c.__valueColumnName?h.Sca.decode(b.rows.item(0)[c.__valueColumnName]):h.Key.decode(b.rows.item(0)[c.__valueColumnName]);f(d,e)}else h.DEBUG&&
console.log("Reached end of cursors"),f(void 0,void 0)},function(a,c){h.DEBUG&&console.log("Could not execute Cursor.continue");d(c)})};k.prototype["continue"]=function(a){var b=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(f,d,c,e){b.__offset++;b.__find(a,f,function(a,d){b.key=a;b.value=d;c("undefined"!==typeof b.key?b:void 0,b.__req)},function(a){e(a)})})};k.prototype.advance=function(a){0>=a&&h.util.throwDOMException("Type Error - Count is invalid - 0 or negative",a);
var b=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(f,d,c,e){b.__offset+=a;b.__find(void 0,f,function(a,d){b.key=a;b.value=d;c("undefined"!==typeof b.key?b:void 0,b.__req)},function(a){e(a)})})};k.prototype.update=function(a){var b=this;return this.__idbObjectStore.transaction.__addToTransactionQueue(function(f,d,c,e){b.__find(void 0,f,function(d){var m="UPDATE "+h.util.quote(b.__idbObjectStore.name)+" SET value = ? WHERE key = ?";h.DEBUG&&console.log(m,a,d);f.executeSql(m,
[h.Sca.encode(a),h.Key.encode(d)],function(a,b){1===b.rowsAffected?c(d):e("No rowns with key found"+d)},function(a,d){e(d)})},function(a){e(a)})})};k.prototype["delete"]=function(){var a=this;return this.__idbObjectStore.transaction.__addToTransactionQueue(function(b,f,d,c){a.__find(void 0,b,function(f){var j="DELETE FROM  "+h.util.quote(a.__idbObjectStore.name)+" WHERE key = ?";h.DEBUG&&console.log(j,f);b.executeSql(j,[h.Key.encode(f)],function(a,b){1===b.rowsAffected?d(void 0):c("No rowns with key found"+
f)},function(a,d){c(d)})},function(a){c(a)})})};h.IDBCursor=k;(function(a,b){function f(a,b){this.indexName=a;this.__idbObjectStore=this.source=b}f.prototype.__createIndex=function(d,b,f){var j=this,m=j.__idbObjectStore.transaction;m.tq.runTask(function(){return s.Deferred(function(u){m.db.__db.transaction(function(g){j.__idbObjectStore.__getStoreProps(g,function(){function h(){a.util.throwDOMException(0,"Could not create new index",arguments);u.reject()}2!==m.mode&&a.util.throwDOMException(0,"Invalid State error, not a version transaction",
j.transaction);var k=JSON.parse(j.__idbObjectStore.__storeProps.indexList);"undefined"!==typeof k[d]&&a.util.throwDOMException(0,"Index already exists on store",k);k[d]={columnName:d,keyPath:b,optionalParams:f};j.__idbObjectStore.__storeProps.indexList=JSON.stringify(k);k=["ALTER TABLE",a.util.quote(j.__idbObjectStore.name),"ADD",d,"BLOB"].join(" ");a.DEBUG&&console.log(k);g.executeSql(k,[],function(f){f.executeSql("SELECT * FROM "+a.util.quote(j.__idbObjectStore.name),[],function(f,e){(function y(m){if(m<
e.rows.length)try{a.Sca.decode(e.rows.item(m).value);var g=eval("value['"+b+"']");f.executeSql("UPDATE "+a.util.quote(j.__idbObjectStore.name)+" set "+d+" = ? where key = ?",[a.Key.encode(g),e.rows.item(m).key],function(){y(m+1)},h)}catch(B){y(m+1)}else a.DEBUG&&console.log("Updating the indexes in table",j.__idbObjectStore.__storeProps),f.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[j.__idbObjectStore.__storeProps.indexList,j.__idbObjectStore.name],function(){j.__idbObjectStore.__setReadyState("createIndex",
!0);u.resolve(j)},h)})(0)},h)},h)},"createObjectStore")})}).promise()},{name:"create index "+d})};f.prototype.openCursor=function(b,c){var f=new a.IDBRequest;new a.IDBCursor(b,c,this.source,f,this.indexName,"value");return f};f.prototype.openKeyCursor=function(b,c){var f=new a.IDBRequest;new a.IDBCursor(b,c,this.source,f,this.indexName,"key");return f};f.prototype.__fetchIndexData=function(d,f){var e=this;return e.__idbObjectStore.transaction.__addToTransactionQueue(function(j,m,u,g){m=["SELECT * FROM ",
a.util.quote(e.__idbObjectStore.name)," WHERE",e.indexName,"NOT NULL"];var h=[];"undefined"!==typeof d&&(m.push("AND",e.indexName," = ?"),h.push(a.Key.encode(d)));a.DEBUG&&console.log("Trying to fetch data for Index",m.join(" "),h);j.executeSql(m.join(" "),h,function(d,e){var j;j="count"===typeof f?e.rows.length:0===e.rows.length?b:"key"===f?a.Key.decode(e.rows.item(0).key):a.Sca.decode(e.rows.item(0).value);u(j)},g)})};f.prototype.get=function(a){return this.__fetchIndexData(a,"value")};f.prototype.getKey=
function(a){return this.__fetchIndexData(a,"key")};f.prototype.count=function(a){return this.__fetchIndexData(a,"count")};a.IDBIndex=f})(h);(function(a){var b=function(b,d,c){this.name=b;this.transaction=d;this.__ready={};this.__setReadyState("createObjectStore","undefined"===typeof c?!0:c);this.indexNames=new a.util.StringList};b.prototype.__setReadyState=function(a,b){this.__ready[a]=b};b.prototype.__waitForReady=function(b,d){var c=!0;if("undefined"!==typeof d)c="undefined"===typeof this.__ready[d]?
!0:this.__ready[d];else for(var e in this.__ready)this.__ready[e]||(c=!1);if(c)b();else{a.DEBUG&&console.log("Waiting for to be ready",d);var j=this;window.setTimeout(function(){j.__waitForReady(b,d)},100)}};b.prototype.__getStoreProps=function(b,d,c){var e=this;this.__waitForReady(function(){e.__storeProps?(a.DEBUG&&console.log("Store properties - cached",e.__storeProps),d(e.__storeProps)):b.executeSql("SELECT * FROM __sys__ where name = ?",[e.name],function(b,c){1!==c.rows.length?d():(e.__storeProps=
{name:c.rows.item(0).name,indexList:c.rows.item(0).indexList,autoInc:c.rows.item(0).autoInc,keyPath:c.rows.item(0).keyPath},a.DEBUG&&console.log("Store properties",e.__storeProps),d(e.__storeProps))},function(){d()})},c)};b.prototype.__deriveKey=function(b,d,c,e){function j(){b.executeSql("SELECT * FROM sqlite_sequence where name like ?",[m.name],function(a,b){1!==b.rows.length?e(0):e(b.rows.item(0).seq)},function(b,c){a.util.throwDOMException(0,"Data Error - Could not get the auto increment value for key",
c)})}var m=this;m.__getStoreProps(b,function(b){b||a.util.throwDOMException(0,"Data Error - Could not locate defination for this table",b);if(b.keyPath)if("undefined"!==typeof c&&a.util.throwDOMException(0,"Data Error - The object store uses in-line keys and the key parameter was provided",b),d)try{var f=eval("value['"+b.keyPath+"']");f?e(f):"true"===b.autoInc?j():a.util.throwDOMException(0,"Data Error - Could not eval key from keyPath")}catch(m){a.util.throwDOMException(0,"Data Error - Could not eval key from keyPath",
m)}else a.util.throwDOMException(0,"Data Error - KeyPath was specified, but value was not");else"undefined"!==typeof c?e(c):"false"===b.autoInc?a.util.throwDOMException(0,"Data Error - The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",b):j()})};b.prototype.__insertData=function(b,d,c,e,j){var m={};"undefined"!==typeof c&&(m.key=a.Key.encode(c));var g=JSON.parse(this.__storeProps.indexList),h;for(h in g)try{m[g[h].columnName]=a.Key.encode(eval("value['"+
g[h].keyPath+"']"))}catch(k){j(k)}var l=["INSERT INTO ",a.util.quote(this.name),"("],n=[" VALUES ("],g=[];for(h in m)l.push(h+","),n.push("?,"),g.push(m[h]);l.push("value )");n.push("?)");g.push(a.Sca.encode(d));d=l.join(" ")+n.join(" ");a.DEBUG&&console.log("SQL for adding",d,g);b.executeSql(d,g,function(){e(c)},function(a,b){j(b)})};b.prototype.add=function(a,b){var c=this;return c.transaction.__addToTransactionQueue(function(e,j,g,h){c.__deriveKey(e,a,b,function(b){c.__insertData(e,a,b,g,h)})})};
b.prototype.put=function(b,d){var c=this;return c.transaction.__addToTransactionQueue(function(e,j,g,h){c.__deriveKey(e,b,d,function(d){var j="DELETE FROM "+a.util.quote(c.name)+" where key = ?";e.executeSql(j,[a.Key.encode(d)],function(e,j){a.DEBUG&&console.log("Did the row with the",d,"exist? ",j.rowsAffected);c.__insertData(e,b,d,g,h)},function(a,b){h(b)})})})};b.prototype.get=function(b){var d=this;return d.transaction.__addToTransactionQueue(function(c,e,j,g){d.__waitForReady(function(){var e=
a.Key.encode(b);a.DEBUG&&console.log("Fetching",d.name,e);c.executeSql("SELECT * FROM "+a.util.quote(d.name)+" where key = ?",[e],function(b,c){a.DEBUG&&console.log("Fetched data",c);try{if(0===c.rows.length)return j();j(a.Sca.decode(c.rows.item(0).value))}catch(d){a.DEBUG&&console.log(d),j(void 0)}},function(a,b){g(b)})})})};b.prototype["delete"]=function(b){var d=this;return d.transaction.__addToTransactionQueue(function(c,e,j,g){d.__waitForReady(function(){var e=a.Key.encode(b);a.DEBUG&&console.log("Fetching",
d.name,e);c.executeSql("DELETE FROM "+a.util.quote(d.name)+" where key = ?",[e],function(b,c){a.DEBUG&&console.log("Deleted from database",c.rowsAffected);j()},function(a,b){g(b)})})})};b.prototype.clear=function(){var b=this;return b.transaction.__addToTransactionQueue(function(d,c,e,j){b.__waitForReady(function(){d.executeSql("DELETE FROM "+a.util.quote(b.name),[],function(b,c){a.DEBUG&&console.log("Cleared all records from database",c.rowsAffected);e()},function(a,b){j(b)})})})};b.prototype.count=
function(b){var d=this;return d.transaction.__addToTransactionQueue(function(c,e,j,g){d.__waitForReady(function(){var e="SELECT * FROM "+a.util.quote(d.name)+("undefined"!==typeof b?" WHERE key = ?":""),h=[];"undefined"!==typeof b&&h.push(a.Key.encode(b));c.executeSql(e,h,function(a,b){j(b.rows.length)},function(a,b){g(b)})})})};b.prototype.openCursor=function(b,d){var c=new a.IDBRequest;new a.IDBCursor(b,d,this,c,"key","value");return c};b.prototype.index=function(b){return new a.IDBIndex(b,this)};
b.prototype.createIndex=function(b,d,c){c=c||{};this.__setReadyState("createIndex",!1);var e=new a.IDBIndex(b,this);e.__createIndex(b,d,c);this.indexNames.push(b);return e};b.prototype.deleteIndex=function(b){var d=new a.IDBIndex(b,this,!1);d.__deleteIndex(b);return d};a.IDBObjectStore=b})(h);var n=h,k=function(a,b,f){if("number"===typeof b)this.mode=b,2!==b&&n.DEBUG&&console.log("Mode should be a string, but was specified as ",b);else if("string"===typeof b)switch(b){case "readonly":this.mode=1;
break;case "readwrite":this.mode=0;break;default:this.mode=0}this.storeNames="string"===typeof a?[a]:a;for(a=0;a<this.storeNames.length;a++)f.objectStoreNames.contains(this.storeNames[a])||n.util.throwDOMException(0,"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened.",this.storeNames[a]);this.__active=!0;this.__running=!1;this.__requests=[];this.__aborted=!1;this.db=f;this.onabort=this.onerror=this.oncomplete=
this.error=null};k.prototype.__executeRequests=function(){if(this.__running&&2!==this.mode)n.DEBUG&&console.log("Looks like the request set is already running",this.mode);else{this.__running=!0;var a=this;window.setTimeout(function(){2!==a.mode&&!a.__active&&n.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",a.__active);a.db.__db.transaction(function(b){function f(a,b){b&&(c.req=b);c.req.readyState="done";c.req.result=a;delete c.req.error;
var d=n.Event("success");n.util.callback("onsuccess",c.req,d);e++;j()}function d(a){c.req.readyState="done";c.req.error="DOMError";var b=n.Event("error",arguments);n.util.callback("onerror",c.req,b);e++;j()}a.__tx=b;var c=null,e=0;try{var j=function(){e>=a.__requests.length?(a.__active=!1,a.__requests=[]):(c=a.__requests[e],c.op(b,c.args,f,d))};j()}catch(g){n.DEBUG&&console.log("An exception occured in transaction",arguments),"function"===typeof a.onerror&&a.onerror()}},function(){n.DEBUG&&console.log("An error in transaction",
arguments);"function"===typeof a.onerror&&a.onerror()},function(){n.DEBUG&&console.log("Transaction completed",arguments);"function"===typeof a.oncomplete&&a.oncomplete()})},1)}};k.prototype.__addToTransactionQueue=function(a,b){!this.__active&&2!==this.mode&&n.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished.",this.__mode);var f=new n.IDBRequest;f.source=this.db;this.__requests.push({op:a,args:b,req:f});this.__executeRequests();
return f};k.prototype.objectStore=function(a){return new n.IDBObjectStore(a,this)};k.prototype.abort=function(){!this.__active&&n.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",this.__active)};k.prototype.READ_ONLY=0;k.prototype.READ_WRITE=1;k.prototype.VERSION_CHANGE=2;n.IDBTransaction=k;var p=h,k=function(a,b,f,d){this.__db=a;this.version=f;this.__storeProperties=d;this.objectStoreNames=new p.util.StringList;for(a=0;a<d.rows.length;a++)this.objectStoreNames.push(d.rows.item(a).name);
this.name=b;this.onabort=this.onerror=this.onversionchange=null};k.prototype.createObjectStore=function(a,b){var f=this;b=b||{};b.keyPath=b.keyPath||null;var d=new p.IDBObjectStore(a,f.__versionTransaction,!1),c=f.__versionTransaction;c.tq.runTask(function(){return s.Deferred(function(e){c.db.__db.transaction(function(c){function g(){e.reject();p.util.throwDOMException(0,"Could not create new object store",arguments)}f.__versionTransaction||(e.reject(),p.util.throwDOMException(0,"Invalid State error",
f.transaction));var h=["CREATE TABLE",p.util.quote(a),"(key BLOB",b.autoIncrement?", inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");p.DEBUG&&console.log(h);c.executeSql(h,[],function(c){c.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[a,b.keyPath,b.autoIncrement?!0:!1,"{}"],function(){d.__setReadyState("createObjectStore",!0);e.resolve(d)},g)},g)})}).promise()},{name:"create object store "+a,sequential:!0});f.objectStoreNames.push(a);return d};k.prototype.deleteObjectStore=
function(a){var b=this;b.__versionTransaction.tq.runTask(function(){return s.Deferred(function(f){var d=function(){f.reject();p.util.throwDOMException(0,"Could not delete ObjectStore",arguments)};!b.objectStoreNames.contains(a)&&d("Object Store does not exist");b.objectStoreNames.splice(b.objectStoreNames.indexOf(a),1);b.__versionTransaction.db.__db.transaction(function(){b.__versionTransaction||p.util.throwDOMException(0,"Invalid State error",b.transaction);b.__db.transaction(function(b){b.executeSql("SELECT * FROM __sys__ where name = ?",
[a],function(b,c){0<c.rows.length&&b.executeSql("DROP TABLE "+p.util.quote(a),[],function(){b.executeSql("DELETE FROM __sys__ WHERE name = ?",[a],function(){f.resolve()},d)},d)})})})}).promise()},{name:"delete object store "+a})};k.prototype.close=function(){};k.prototype.transaction=function(a,b){return new p.IDBTransaction(a,b||1,this)};p.IDBDatabase=k;var l=h,v=4194304;if(window.openDatabase){var r=window.openDatabase("__sysdb__",1,"System Database",v);r.transaction(function(a){a.executeSql("SELECT * FROM dbVersions",
[],function(){},function(){r.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[],function(){},function(){l.util.throwDOMException("Could not create table __sysdb__ to save DB versions")})})})},function(){l.DEBUG&&console.log("Error in sysdb transaction - when selecting from dbVersions",arguments)});l.shimIndexedDB={open:function(a,b){function f(){if(!e){var a=l.Event("error",arguments);c.readyState="done";c.error="DOMError";l.util.callback("onerror",
c,a);e=!0}}function d(d){var e=window.openDatabase(a,1,a,v);c.readyState="done";"undefined"===typeof b&&(b=d||1);(0>=b||d>b)&&l.util.throwDOMException(0,"An attempt was made to open a database using a lower version than the existing version.",b);e.transaction(function(g){g.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){g.executeSql("SELECT * FROM __sys__",[],function(g,h){var k=l.Event("success");c.source=c.result=
new l.IDBDatabase(e,a,b,h);d<b?r.transaction(function(e){e.executeSql("UPDATE dbVersions set version = ? where name = ?",[b,a],function(){var a=l.Event("upgradeneeded");a.oldVersion=d;a.newVersion=b;var e=c.transaction=c.result.__versionTransaction=new l.IDBTransaction([],2,c.source);e.tq=new A("IDBShim upgrade to "+b);l.util.callback("onupgradeneeded",c,a,function(){e.tq.runTask(function(){return s.Deferred(function(a){var b=l.Event("success");l.util.callback("onsuccess",c,b);a.resolve()}).promise()},
{name:"Complete upgrade transaction",sequential:!0,yield:!0})})},f)},f):l.util.callback("onsuccess",c,k)},f)},f)},f)}var c=new l.IDBOpenRequest,e=!1;r.transaction(function(c){c.executeSql("SELECT * FROM dbVersions where name = ?",[a],function(c,e){0===e.rows.length?c.executeSql("INSERT INTO dbVersions VALUES (?,?)",[a,b||1],function(){d(0)},f):d(e.rows.item(0).version)},f)},f);return c},deleteDatabase:function(a){function b(a){if(!c){d.readyState="done";d.error="DOMError";var b=l.Event("error");b.message=
a;b.debug=arguments;l.util.callback("onerror",d,b);c=!0}}function f(){r.transaction(function(c){c.executeSql("DELETE FROM dbVersions where name = ? ",[a],function(){d.result=void 0;var a=l.Event("success");a.newVersion=null;a.oldVersion=e;l.util.callback("onsuccess",d,a)},b)},b)}var d=new l.IDBOpenRequest,c=!1,e=null;r.transaction(function(c){c.executeSql("SELECT * FROM dbVersions where name = ?",[a],function(c,g){if(0===g.rows.length){d.result=void 0;var h=l.Event("success");h.newVersion=null;h.oldVersion=
e;l.util.callback("onsuccess",d,h)}else e=g.rows.item(0).version,window.openDatabase(a,1,a,v).transaction(function(a){a.executeSql("SELECT * FROM __sys__",[],function(a,c){var d=c.rows;(function z(c){c>=d.length?a.executeSql("DROP TABLE __sys__",[],function(){f()},b):a.executeSql("DROP TABLE "+l.util.quote(d.item(c).name),[],function(){z(c+1)},function(){z(c+1)})})(0)},function(){f()})},b)})},b);return d},cmp:function(a,b){return l.Key.encode(a)>l.Key.encode(b)?1:a===b?0:-1}}}var g=window;"undefined"!==
typeof g.openDatabase&&(g.shimIndexedDB=h.shimIndexedDB,g.shimIndexedDB&&(g.shimIndexedDB.__useShim=function(){g.indexedDB=h.shimIndexedDB;g.IDBDatabase=h.IDBDatabase;g.IDBTransaction=h.IDBTransaction;g.IDBRequest=h.IDBRequest;g.IDBObjectStore=h.IDBObjectStore;g.IDBCursor=h.IDBCursor;g.IDBIndex=h.IDBIndex;g.IDBKeyRange=h.IDBKeyRange},g.shimIndexedDB.__debug=function(a){h.DEBUG=a}));g.indexedDB=g.indexedDB||g.webkitIndexedDB||g.mozIndexedDB||g.oIndexedDB||g.msIndexedDB;"undefined"===typeof g.indexedDB&&
"undefined"!==typeof g.openDatabase?g.shimIndexedDB.__useShim():(g.IDBDatabase=g.IDBDatabase||g.webkitIDBDatabase,g.IDBTransaction=g.IDBTransaction||g.webkitIDBTransaction,g.IDBCursor=g.IDBCursor||g.webkitIDBCursor,g.IDBRequest=g.IDBRequest||g.webkitIDBRequest,g.IDBIndex=g.IDBIndex||g.webkitIDBIndex,g.IDBObjectStore=g.IDBObjectStore||g.webkitIDBObjectStore,g.IDBKeyRange=g.IDBKeyRange||g.webkitIDBKeyRange,g.IDBTransaction.READ_ONLY=g.IDBTransaction.READ_ONLY||"readonly",g.IDBTransaction.READ_WRITE=
g.IDBTransaction.READ_WRITE||"readwrite")});
